<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Contributing &mdash; Celery v2.4.0a1 documentation</title>
    <link rel="stylesheet" href="_static/celery.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/issuetracker.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '2.4.0a1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Celery v2.4.0a1 documentation" href="index.html" />
    <link rel="next" title="Community Resources" href="community.html" />
    <link rel="prev" title="Running celeryd as a daemon" href="cookbook/daemonizing.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="community.html" title="Community Resources"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="cookbook/daemonizing.html" title="Running celeryd as a daemon"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Celery v2.4.0a1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
<div class="deck">

    
        <p class="developmentversion">
        This document is for Celery's development version, which can be
        significantly different from previous releases. Get old docs here:

        <a href="http://docs.celeryproject.org/en/latest/contributing.html">2.1</a>.
        </p>
        

</div>
    <div class="section" id="contributing">
<span id="id1"></span><h1>Contributing<a class="headerlink" href="#contributing" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#community-code-of-conduct" id="id6">Community Code of Conduct</a><ul>
<li><a class="reference internal" href="#be-considerate" id="id7">Be considerate.</a></li>
<li><a class="reference internal" href="#be-respectful" id="id8">Be respectful.</a></li>
<li><a class="reference internal" href="#be-collaborative" id="id9">Be collaborative.</a></li>
<li><a class="reference internal" href="#when-you-disagree-consult-others" id="id10">When you disagree, consult others.</a></li>
<li><a class="reference internal" href="#when-you-are-unsure-ask-for-help" id="id11">When you are unsure, ask for help.</a></li>
<li><a class="reference internal" href="#step-down-considerately" id="id12">Step down considerately.</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reporting-a-bug" id="id13">Reporting a Bug</a><ul>
<li><a class="reference internal" href="#issue-trackers" id="id14">Issue Trackers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#versions" id="id15">Versions</a></li>
<li><a class="reference internal" href="#branches" id="id16">Branches</a><ul>
<li><a class="reference internal" href="#master-branch" id="id17"><tt class="docutils literal"><span class="pre">master</span></tt> branch</a></li>
<li><a class="reference internal" href="#maintenance-branches" id="id18">Maintenance branches</a></li>
<li><a class="reference internal" href="#archived-branches" id="id19">Archived branches</a></li>
<li><a class="reference internal" href="#feature-branches" id="id20">Feature branches</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tags" id="id21">Tags</a></li>
<li><a class="reference internal" href="#working-on-features-patches" id="id22">Working on Features &amp; Patches</a><ul>
<li><a class="reference internal" href="#forking-and-setting-up-the-repository" id="id23">Forking and setting up the repository</a></li>
<li><a class="reference internal" href="#running-the-unit-test-suite" id="id24">Running the unit test suite</a></li>
<li><a class="reference internal" href="#creating-pull-requests" id="id25">Creating pull requests</a><ul>
<li><a class="reference internal" href="#calculating-test-coverage" id="id26">Calculating test coverage</a></li>
<li><a class="reference internal" href="#running-the-tests-on-all-supported-python-versions" id="id27">Running the tests on all supported Python versions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#building-the-documentation" id="id28">Building the documentation</a></li>
<li><a class="reference internal" href="#verifying-your-contribution" id="id29">Verifying your contribution</a><ul>
<li><a class="reference internal" href="#pyflakes-pep8" id="id30">pyflakes &amp; PEP8</a></li>
<li><a class="reference internal" href="#api-reference" id="id31">API reference</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#coding-style" id="id32">Coding Style</a></li>
<li><a class="reference internal" href="#release-procedure" id="id33">Release Procedure</a></li>
</ul>
</div>
<div class="section" id="community-code-of-conduct">
<span id="id2"></span><h2><a class="toc-backref" href="#id6">Community Code of Conduct</a><a class="headerlink" href="#community-code-of-conduct" title="Permalink to this headline">¶</a></h2>
<p>The goal is to maintain a diverse community that is pleasant for everyone.
That is why we would greatly appreciate it if everyone contributing to and
interacting with the community also followed this Code of Conduct.</p>
<p>The Code of Conduct covers our behavior as members of the community,
in any forum, mailing list, wiki, website, Internet relay chat (IRC), public
meeting or private correspondence.</p>
<p>The Code of Conduct is heavily based on the <a class="reference external" href="http://www.ubuntu.com/community/conduct">Ubuntu Code of Conduct</a>, and
the <a class="reference external" href="http://docs.pylonshq.com/community/conduct.html">Pylons Code of Conduct</a>.</p>
<div class="section" id="be-considerate">
<h3><a class="toc-backref" href="#id7">Be considerate.</a><a class="headerlink" href="#be-considerate" title="Permalink to this headline">¶</a></h3>
<p>Your work will be used by other people, and you in turn will depend on the
work of others.  Any decision you take will affect users and colleagues, and
we expect you to take those consequences into account when making decisions.
Even if it&#8217;s not obvious at the time, our contributions to Ubuntu will impact
the work of others.  For example, changes to code, infrastructure, policy,
documentation and translations during a release may negatively impact
others work.</p>
</div>
<div class="section" id="be-respectful">
<h3><a class="toc-backref" href="#id8">Be respectful.</a><a class="headerlink" href="#be-respectful" title="Permalink to this headline">¶</a></h3>
<p>The Celery community and its members treat one another with respect.  Everyone
can make a valuable contribution to Celery.  We may not always agree, but
disagreement is no excuse for poor behavior and poor manners.  We might all
experience some frustration now and then, but we cannot allow that frustration
to turn into a personal attack.  It&#8217;s important to remember that a community
where people feel uncomfortable or threatened is not a productive one.  We
expect members of the Celery community to be respectful when dealing with
other contributors as well as with people outside the Celery project and with
users of Celery.</p>
</div>
<div class="section" id="be-collaborative">
<h3><a class="toc-backref" href="#id9">Be collaborative.</a><a class="headerlink" href="#be-collaborative" title="Permalink to this headline">¶</a></h3>
<p>Collaboration is central to Celery and to the larger free software community.
We should always be open to collaboration.  Your work should be done
transparently and patches from Celery should be given back to the community
when they are made, not just when the distribution releases.  If you wish
to work on new code for existing upstream projects, at least keep those
projects informed of your ideas and progress.  It many not be possible to
get consensus from upstream, or even from your colleagues about the correct
implementation for an idea, so don&#8217;t feel obliged to have that agreement
before you begin, but at least keep the outside world informed of your work,
and publish your work in a way that allows outsiders to test, discuss and
contribute to your efforts.</p>
</div>
<div class="section" id="when-you-disagree-consult-others">
<h3><a class="toc-backref" href="#id10">When you disagree, consult others.</a><a class="headerlink" href="#when-you-disagree-consult-others" title="Permalink to this headline">¶</a></h3>
<p>Disagreements, both political and technical, happen all the time and
the Celery community is no exception.  It is important that we resolve
disagreements and differing views constructively and with the help of the
community and community process.  If you really want to go a different
way, then we encourage you to make a derivative distribution or alternate
set of packages that still build on the work we&#8217;ve done to utilize as common
of a core as possible.</p>
</div>
<div class="section" id="when-you-are-unsure-ask-for-help">
<h3><a class="toc-backref" href="#id11">When you are unsure, ask for help.</a><a class="headerlink" href="#when-you-are-unsure-ask-for-help" title="Permalink to this headline">¶</a></h3>
<p>Nobody knows everything, and nobody is expected to be perfect.  Asking
questions avoids many problems down the road, and so questions are
encouraged.  Those who are asked questions should be responsive and helpful.
However, when asking a question, care must be taken to do so in an appropriate
forum.</p>
</div>
<div class="section" id="step-down-considerately">
<h3><a class="toc-backref" href="#id12">Step down considerately.</a><a class="headerlink" href="#step-down-considerately" title="Permalink to this headline">¶</a></h3>
<p>Developers on every project come and go and Celery is no different.  When you
leave or disengage from the project, in whole or in part, we ask that you do
so in a way that minimizes disruption to the project.  This means you should
tell people you are leaving and take the proper steps to ensure that others
can pick up where you leave off.</p>
</div>
</div>
<div class="section" id="reporting-a-bug">
<span id="reporting-bugs"></span><h2><a class="toc-backref" href="#id13">Reporting a Bug</a><a class="headerlink" href="#reporting-a-bug" title="Permalink to this headline">¶</a></h2>
<p>Bugs can always be described to the <a class="reference internal" href="getting-started/resources.html#mailing-list"><em>Mailing list</em></a>, but the best
way to report an issue and to ensure a timely response is to use the
issue tracker.</p>
<ol class="arabic simple">
<li>Create a GitHub account.</li>
</ol>
<p>You need to <a class="reference external" href="https://github.com/signup/free">create a GitHub account</a> to be able to create new issues
and participate in the discussion.</p>
<ol class="arabic simple" start="2">
<li>Determine if your bug is really a bug.</li>
</ol>
<p>You should not file a bug if you are requesting support.  For that you can use
the <a class="reference internal" href="getting-started/resources.html#mailing-list"><em>Mailing list</em></a>, or <a class="reference internal" href="getting-started/resources.html#irc-channel"><em>IRC</em></a>.</p>
<ol class="arabic simple" start="3">
<li>Make sure your bug hasn&#8217;t already been reported.</li>
</ol>
<p>Search through the appropriate Issue tracker.  If a bug like yours was found,
check if you have new information that could be reported to help
the developers fix the bug.</p>
<ol class="arabic simple" start="4">
<li>Collect information about the bug.</li>
</ol>
<p>To have the best chance of having a bug fixed, we need to be able to easily
reproduce the conditions that caused it.  Most of the time this information
will be from a Python traceback message, though some bugs might be in design,
spelling or other errors on the website/docs/code.</p>
<p>If the error is from a Python traceback, include it in the bug report.</p>
<p>We also need to know what platform you&#8217;re running (Windows, OSX, Linux, etc),
the version of your Python interpreter, and the version of Celery, and related
packages that you were running when the bug occurred.</p>
<ol class="arabic simple" start="5">
<li>Submit the bug.</li>
</ol>
<p>By default <a class="reference external" href="http://github.com">GitHub</a> will email you to let you know when new comments have
been made on your bug. In the event you&#8217;ve turned this feature off, you
should check back on occasion to ensure you don&#8217;t miss any questions a
developer trying to fix the bug might ask.</p>
<div class="section" id="issue-trackers">
<span id="id3"></span><h3><a class="toc-backref" href="#id14">Issue Trackers</a><a class="headerlink" href="#issue-trackers" title="Permalink to this headline">¶</a></h3>
<p>Bugs for a package in the Celery ecosystem should be reported to the relevant
issue tracker.</p>
<ul class="simple">
<li>Celery: <a class="reference external" href="http://github.com/ask/celery/issues/">http://github.com/ask/celery/issues/</a></li>
<li>Django-Celery: <a class="reference external" href="http://github.com/ask/django-celery/issues">http://github.com/ask/django-celery/issues</a></li>
<li>Flask-Celery: <a class="reference external" href="http://github.com/ask/flask-celery/issues">http://github.com/ask/flask-celery/issues</a></li>
<li>Celery-Pylons: <a class="reference external" href="http://bitbucket.org/ianschenck/celery-pylons/issues">http://bitbucket.org/ianschenck/celery-pylons/issues</a></li>
<li>Kombu: <a class="reference external" href="http://github.com/ask/kombu/issues">http://github.com/ask/kombu/issues</a></li>
</ul>
<p>If you are unsure of the origin of the bug you can ask the
<a class="reference internal" href="getting-started/resources.html#mailing-list"><em>Mailing list</em></a>, or just use the Celery issue tracker.</p>
</div>
</div>
<div class="section" id="versions">
<h2><a class="toc-backref" href="#id15">Versions</a><a class="headerlink" href="#versions" title="Permalink to this headline">¶</a></h2>
<p>Version numbers consists of a major version, minor version and a release number.
Since version 2.1.0 we use the versioning semantics described by
semver: <a class="reference external" href="http://semver.org">http://semver.org</a>.</p>
<p>Stable releases are published at PyPI
while development releases are only available in the GitHub git repository as tags.
All version tags starts with “v”, so version 0.8.0 is the tag v0.8.0.</p>
</div>
<div class="section" id="branches">
<span id="git-branches"></span><h2><a class="toc-backref" href="#id16">Branches</a><a class="headerlink" href="#branches" title="Permalink to this headline">¶</a></h2>
<p>Current active version branches:</p>
<ul class="simple">
<li>master (<a class="reference external" href="http://github.com/ask/celery/tree/master">http://github.com/ask/celery/tree/master</a>)</li>
<li>3.0-devel (<a class="reference external" href="http://github.com/ask/celery/tree/3.0-devel">http://github.com/ask/celery/tree/3.0-devel</a>)</li>
</ul>
<p>You can see the state of any branch by looking at the Changelog:</p>
<blockquote>
<div><a class="reference external" href="https://github.com/ask/celery/blob/master/Changelog">https://github.com/ask/celery/blob/master/Changelog</a></div></blockquote>
<p>If the branch is in active development the topmost version info should
contain metadata like:</p>
<div class="highlight-python"><pre>2.4.0
======
:release-date: TBA
:status: DEVELOPMENT
:branch: master</pre>
</div>
<p>The <tt class="docutils literal"><span class="pre">status</span></tt> field can be one of:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">PLANNING</span></tt></p>
<blockquote>
<div><p>The branch is currently experimental and in the planning stage.</p>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">DEVELOPMENT</span></tt></p>
<blockquote>
<div><p>The branch is in active development, but the test suite should
be passing and the product should be working and possible for users to test.</p>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">FROZEN</span></tt></p>
<blockquote>
<div><p>The branch is frozen, and no more features will be accepted.
When a branch is frozen the focus is on testing the version as much
as possible before it is released.</p>
</div></blockquote>
</li>
</ul>
<div class="section" id="master-branch">
<h3><a class="toc-backref" href="#id17"><tt class="docutils literal"><span class="pre">master</span></tt> branch</a><a class="headerlink" href="#master-branch" title="Permalink to this headline">¶</a></h3>
<p>The master branch is where development of the next version happens.</p>
</div>
<div class="section" id="maintenance-branches">
<h3><a class="toc-backref" href="#id18">Maintenance branches</a><a class="headerlink" href="#maintenance-branches" title="Permalink to this headline">¶</a></h3>
<p>Maintenance branches are named after the version, e.g. the maintenance branch
for the 2.2.x series is named <tt class="docutils literal"><span class="pre">2.2</span></tt>.  Previously these were named
<tt class="docutils literal"><span class="pre">releaseXX-maint</span></tt>.</p>
<p>The versions we currently maintain is:</p>
<ul>
<li><p class="first">2.3</p>
<p>This is the current series.</p>
</li>
<li><p class="first">2.2</p>
<p>This is the previous series, and the last version to support Python 2.4.</p>
</li>
<li><p class="first">2.1</p>
<p>This is the last version to use the <tt class="docutils literal"><span class="pre">carrot</span></tt> AMQP framework.
Recent versions use <tt class="docutils literal"><span class="pre">kombu</span></tt>.</p>
</li>
</ul>
</div>
<div class="section" id="archived-branches">
<h3><a class="toc-backref" href="#id19">Archived branches</a><a class="headerlink" href="#archived-branches" title="Permalink to this headline">¶</a></h3>
<p>Archived branches are kept for preserving history only,
and theoretically someone could provide patches for these if they depend
on a series that is no longer officially supported.</p>
<p>An archived version is named <tt class="docutils literal"><span class="pre">X.Y-archived</span></tt>.</p>
<p>Our currently archived branches are:</p>
<ul class="simple">
<li>2.1-archived</li>
<li>2.0-archived</li>
<li>1.0-archived</li>
</ul>
</div>
<div class="section" id="feature-branches">
<h3><a class="toc-backref" href="#id20">Feature branches</a><a class="headerlink" href="#feature-branches" title="Permalink to this headline">¶</a></h3>
<p>Major new features are worked on in dedicated branches.
There is no strict naming requirement for these branches.</p>
<p>Feature branches are removed once they have been merged into a release branch.</p>
</div>
</div>
<div class="section" id="tags">
<h2><a class="toc-backref" href="#id21">Tags</a><a class="headerlink" href="#tags" title="Permalink to this headline">¶</a></h2>
<p>Tags are used exclusively for tagging releases.  A release tag is
named with the format <tt class="docutils literal"><span class="pre">vX.Y.Z</span></tt>, e.g. <tt class="docutils literal"><span class="pre">v2.3.1</span></tt>.
Experimental releases contain an additional identifier <tt class="docutils literal"><span class="pre">vX.Y.Z-id</span></tt>, e.g.
<tt class="docutils literal"><span class="pre">v3.0.0-rc1</span></tt>.  Experimental tags may be removed after the official release.</p>
</div>
<div class="section" id="working-on-features-patches">
<span id="contributing-changes"></span><h2><a class="toc-backref" href="#id22">Working on Features &amp; Patches</a><a class="headerlink" href="#working-on-features-patches" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Contributing to Celery should be as simple as possible,
so none of these steps should be considered mandatory.</p>
<p>You can even send in patches by email if that is your preferred
work method. We won&#8217;t like you any less, any contribution you make
is always appreciated!</p>
<p class="last">However following these steps may make maintainers life easier,
and may mean that your changes will be accepted sooner.</p>
</div>
<div class="section" id="forking-and-setting-up-the-repository">
<h3><a class="toc-backref" href="#id23">Forking and setting up the repository</a><a class="headerlink" href="#forking-and-setting-up-the-repository" title="Permalink to this headline">¶</a></h3>
<p>First you need to fork the Celery repository, a good introduction to this
is in the Github Guide: <a class="reference external" href="http://help.github.com/fork-a-repo/">Fork a Repo</a>.</p>
<p>After you have cloned the repository you should checkout your copy
to a directory on your machine:</p>
<div class="highlight-python"><pre>$ git clone git@github.com:username/celery.git</pre>
</div>
<p>When the repository is cloned enter the directory to set up easy access
to upstream changes:</p>
<div class="highlight-python"><pre>$ cd celery
$ git remote add upstream git://github.com/ask/celery.git
$ git fetch upstream</pre>
</div>
<p>If you need to pull in new changes from upstream you should
always use the <em class="xref std std-option">--rebase</em> option to <tt class="docutils literal"><span class="pre">git</span> <span class="pre">pull</span></tt>:</p>
<div class="highlight-python"><pre>git pull --rebase upstream master</pre>
</div>
<p>With this option you don&#8217;t clutter the history with merging
commit notes. See <a class="reference external" href="http://notes.envato.com/developers/rebasing-merge-commits-in-git/">Rebasing merge commits in git</a>.
If you want to learn more about rebasing see the <a class="reference external" href="http://help.github.com/rebase/">Rebase</a>
section in the Github guides.</p>
<p>If you need to work on a different branch than <tt class="docutils literal"><span class="pre">master</span></tt> you can
fetch and checkout a remote branch like this:</p>
<div class="highlight-python"><pre>git checkout --track -b 3.0-devel origin/3.0-devel</pre>
</div>
<p>For a list of branches see <a class="reference internal" href="#git-branches"><em>Branches</em></a>.</p>
</div>
<div class="section" id="running-the-unit-test-suite">
<span id="contributing-testing"></span><h3><a class="toc-backref" href="#id24">Running the unit test suite</a><a class="headerlink" href="#running-the-unit-test-suite" title="Permalink to this headline">¶</a></h3>
<p>To run the Celery test suite you need to install a few dependencies.
A complete list of the dependencies needed are located in
<tt class="file docutils literal"><span class="pre">requirements/test.txt</span></tt>.</p>
<p>Installing the test requirements:</p>
<div class="highlight-python"><pre>$ pip -E $VIRTUAL_ENV install -U -r requirements/test.txt</pre>
</div>
<p>When installation of dependencies is complete you can execute
the test suite by calling <tt class="docutils literal"><span class="pre">nosetests</span></tt>:</p>
<div class="highlight-python"><pre>$ nosetests</pre>
</div>
<p>Some useful options to <strong class="program">nosetests</strong> are:</p>
<ul>
<li><p class="first"><em class="xref std std-option">-x</em></p>
<blockquote>
<div><p>Stop running the tests at the first test that fails.</p>
</div></blockquote>
</li>
<li><p class="first"><em class="xref std std-option">-s</em></p>
<blockquote>
<div><p>Don&#8217;t capture output</p>
</div></blockquote>
</li>
<li><p class="first"><em class="xref std std-option">--nologcapture</em></p>
<blockquote>
<div><p>Don&#8217;t capture log output.</p>
</div></blockquote>
</li>
<li><p class="first"><em class="xref std std-option">-v</em></p>
<blockquote>
<div><p>Run with verbose output.</p>
</div></blockquote>
</li>
</ul>
<p>If you want to run the tests for a single test file only
you can do so like this:</p>
<div class="highlight-python"><pre>$ nosetests celery.tests.test_worker.test_worker_job</pre>
</div>
</div>
<div class="section" id="creating-pull-requests">
<span id="contributing-pull-requests"></span><h3><a class="toc-backref" href="#id25">Creating pull requests</a><a class="headerlink" href="#creating-pull-requests" title="Permalink to this headline">¶</a></h3>
<p>When your feature/bugfix is complete you may want to submit
a pull requests so that it can be reviewed by the maintainers.</p>
<p>Creating pull requests is easy, and also let you track the progress
of your contribution.  Read the <a class="reference external" href="http://help.github.com/send-pull-requests/">Pull Requests</a> section in the Github
Guide to learn how this is done.</p>
<p>You can also attach pull requests to existing issues by following
the steps outlined here: <a class="reference external" href="http://bit.ly/koJoso">http://bit.ly/koJoso</a></p>
<div class="section" id="calculating-test-coverage">
<span id="contributing-coverage"></span><h4><a class="toc-backref" href="#id26">Calculating test coverage</a><a class="headerlink" href="#calculating-test-coverage" title="Permalink to this headline">¶</a></h4>
<p>Code coverage in HTML:</p>
<div class="highlight-python"><pre>$ nosetests --with-coverage3 --cover3-html</pre>
</div>
<p>The coverage output will then be located at
<tt class="file docutils literal"><span class="pre">celery/tests/cover/index.html</span></tt>.</p>
<p>Code coverage in XML (Cobertura-style):</p>
<div class="highlight-python"><pre>$ nosetests --with-coverage3 --cover3-xml --cover3-xml-file=coverage.xml</pre>
</div>
<p>The coverage XML output will then be located at <tt class="file docutils literal"><span class="pre">coverage.xml</span></tt></p>
</div>
<div class="section" id="running-the-tests-on-all-supported-python-versions">
<span id="contributing-tox"></span><h4><a class="toc-backref" href="#id27">Running the tests on all supported Python versions</a><a class="headerlink" href="#running-the-tests-on-all-supported-python-versions" title="Permalink to this headline">¶</a></h4>
<p>There is a <tt class="docutils literal"><span class="pre">tox</span></tt> configuration file in the top directory of the
distribution.</p>
<p>To run the tests for all supported Python versions simply execute:</p>
<div class="highlight-python"><pre>$ tox</pre>
</div>
<p>If you only want to test specific Python versions use the <em class="xref std std-option">-e</em>
option:</p>
<div class="highlight-python"><pre>$ tox -e py25,py26</pre>
</div>
</div>
</div>
<div class="section" id="building-the-documentation">
<h3><a class="toc-backref" href="#id28">Building the documentation</a><a class="headerlink" href="#building-the-documentation" title="Permalink to this headline">¶</a></h3>
<p>To build the documentation you need to install the dependencies
listed in <tt class="file docutils literal"><span class="pre">requirements/docs.txt</span></tt>:</p>
<div class="highlight-python"><pre>$ pip -E $VIRTUAL_ENV install -U -r requirements/docs.txt</pre>
</div>
<p>After these dependencies are installed you should be able to
build the docs by running:</p>
<div class="highlight-python"><pre>$ cd docs
$ rm -rf .build
$ make html</pre>
</div>
<p>Make sure there are no errors or warnings in the build output.
After building succeeds the documentation is available at <tt class="file docutils literal"><span class="pre">.build/html</span></tt>.</p>
</div>
<div class="section" id="verifying-your-contribution">
<span id="contributing-verify"></span><h3><a class="toc-backref" href="#id29">Verifying your contribution</a><a class="headerlink" href="#verifying-your-contribution" title="Permalink to this headline">¶</a></h3>
<p>To use these tools you need to install a few dependencies.  These dependencies
can be found in <tt class="file docutils literal"><span class="pre">requirements/pkgutils.txt</span></tt>.</p>
<p>Installing the dependencies:</p>
<div class="highlight-python"><pre>$ pip -E $VIRTUAL_ENV install -U -r requirements/pkgutils.txt</pre>
</div>
<div class="section" id="pyflakes-pep8">
<h4><a class="toc-backref" href="#id30">pyflakes &amp; PEP8</a><a class="headerlink" href="#pyflakes-pep8" title="Permalink to this headline">¶</a></h4>
<p>To ensure that your changes conform to PEP8 and to run pyflakes
execute:</p>
<div class="highlight-python"><pre>$ paver flake8</pre>
</div>
<p>To not return a negative exit code when this command fails use the
<em class="xref std std-option">-E</em> option, this can be convenient while developing:</p>
<div class="highlight-python"><pre>$ paver flake8 -E</pre>
</div>
</div>
<div class="section" id="api-reference">
<h4><a class="toc-backref" href="#id31">API reference</a><a class="headerlink" href="#api-reference" title="Permalink to this headline">¶</a></h4>
<p>To make sure that all modules have a corresponding section in the API
reference please execute:</p>
<div class="highlight-python"><pre>$ paver autodoc
$ paver verifyindex</pre>
</div>
<p>If files are missing you can add them by copying an existing reference file.</p>
<p>If the module is internal it should be part of the internal reference
located in <tt class="file docutils literal"><span class="pre">docs/internals/reference/</span></tt>.  If the module is public
it should be located in <tt class="file docutils literal"><span class="pre">docs/reference/</span></tt>.</p>
<p>For example if reference is missing for the module <tt class="docutils literal"><span class="pre">celery.worker.awesome</span></tt>
and this module is considered part of the public API, use the following steps:</p>
<div class="highlight-python"><pre>$ cd docs/reference/
$ cp celery.schedules.rst celery.worker.awesome.rst
$ vim celery.worker.awesome.rst

    # change every occurance of ``celery.schedules`` to
    # ``celery.worker.awesome``

$ vim index.rst

    # Add ``celery.worker.awesome`` to the index.

# Add the file to git
$ git add celery.worker.awesome.rst
$ git add index.rst
$ git commit celery.worker.awesome.rst index.rst \
    -m "Adds reference for celery.worker.awesome"</pre>
</div>
</div>
</div>
</div>
<div class="section" id="coding-style">
<span id="id4"></span><h2><a class="toc-backref" href="#id32">Coding Style</a><a class="headerlink" href="#coding-style" title="Permalink to this headline">¶</a></h2>
<p>You should probably be able to pick up the coding style
from surrounding code, but it is a good idea to be aware of the
following conventions.</p>
<ul class="simple">
<li>All Python code must follow the <a class="reference external" href="http://www.python.org/dev/peps/pep-0008/">PEP-8</a> guidelines.</li>
</ul>
<p><a class="reference external" href="http://pypi.python.org/pypi/pep8">pep8.py</a> is an utility you can use to verify that your code
is following the conventions.</p>
<ul>
<li><p class="first">Docstrings must follow the <a class="reference external" href="http://www.python.org/dev/peps/pep-0257/">PEP-257</a> conventions, and use the following
style.</p>
<blockquote>
<div><p>Do this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Short description.</span>

<span class="sd">    More details.</span>

<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Short description.&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>but not this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Short description.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
<ul>
<li><p class="first">Lines should not exceed 78 columns.</p>
<p>You can enforce this in <strong class="program">vim</strong> by setting the <tt class="docutils literal"><span class="pre">textwidth</span></tt> option:</p>
<div class="highlight-python"><pre>.. code-block:: vim</pre>
</div>
<blockquote>
<div><blockquote>
<div><p>set textwidth=78</p>
</div></blockquote>
<p>If adhering to this limit makes the code less readable, you have one more
character to go on, which means 78 is a soft limit, and 79 is the hard
limit :)</p>
</div></blockquote>
</li>
<li><p class="first">Import order</p>
<blockquote>
<div><ul class="simple">
<li>Python standard library (<cite>import xxx</cite>)</li>
<li>Python standard library (&#8216;from xxx import`)</li>
<li>Third party packages.</li>
<li>Other modules from the current package.</li>
</ul>
<p>or in case of code using Django:</p>
<ul class="simple">
<li>Python standard library (<cite>import xxx</cite>)</li>
<li>Python standard library (&#8216;from xxx import`)</li>
<li>Third party packages.</li>
<li>Django packages.</li>
<li>Other modules from the current package.</li>
</ul>
<p>Within these sections the imports should be sorted by module name.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">deque</span>
<span class="kn">from</span> <span class="nn">Queue</span> <span class="kn">import</span> <span class="n">Queue</span><span class="p">,</span> <span class="n">Empty</span>

<span class="kn">from</span> <span class="nn">.datastructures</span> <span class="kn">import</span> <span class="n">TokenBucket</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="n">timeutils</span>
<span class="kn">from</span> <span class="nn">.utils.compat</span> <span class="kn">import</span> <span class="nb">all</span><span class="p">,</span> <span class="n">izip_longest</span><span class="p">,</span> <span class="n">chain_from_iterable</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Wildcard imports must not be used (<cite>from xxx import *</cite>).</p>
</li>
<li><p class="first">For distributions where Python 2.5 is the oldest support version
additional rules apply:</p>
<blockquote>
<div><ul>
<li><p class="first">Absolute imports must be enabled at the top of every module:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span>
</pre></div>
</div>
</li>
<li><p class="first">If the module uses the with statement it must also enable that:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">with_statement</span>
</pre></div>
</div>
</li>
<li><p class="first">Every future import must be on its own line, as older Python 2.5
releases did not support importing multiple features on the
same future import line:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Good</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">with_statement</span>

<span class="c"># Bad</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">with_statement</span>
</pre></div>
</div>
</li>
</ul>
<blockquote>
<div><p>(Note that this rule does not apply if the package does not include
support for Python 2.5)</p>
</div></blockquote>
</div></blockquote>
</li>
<li><p class="first">Note that we use &#8220;new-style` relative imports when the distribution
does not support Python versions below 2.5</p>
</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">submodule</span>
</pre></div>
</div>
</div>
<div class="section" id="release-procedure">
<span id="id5"></span><h2><a class="toc-backref" href="#id33">Release Procedure</a><a class="headerlink" href="#release-procedure" title="Permalink to this headline">¶</a></h2>
<p>Commands to make a new public stable release:</p>
<div class="highlight-python"><pre>$ paver releaseok     # checks pep8, autodoc index and runs tests
$ paver removepyc  # Remove .pyc files.
$ git clean -xdn # Check that there's no left-over files in the repository.
$ python2.5 setup.py sdist upload # Upload package to PyPI
$ paver upload_pypi_docs
$ paver ghdocs # Build and upload documentation to Github.</pre>
</div>
<p>If this is a new release series then you also need to do the
following:</p>
<ul>
<li><dl class="first docutils">
<dt>Go to the Read The Docs management interface at:</dt>
<dd><p class="first last"><a class="reference external" href="http://readthedocs.org/projects/celery/?fromdocs=celery">http://readthedocs.org/projects/celery/?fromdocs=celery</a></p>
</dd>
</dl>
</li>
<li><p class="first">Enter &#8220;Edit project&#8221;</p>
<blockquote>
<div><p>Change default branch to the branch of this series, e.g. <tt class="docutils literal"><span class="pre">2.4</span></tt>
for series 2.4.</p>
</div></blockquote>
</li>
<li><p class="first">Also add the previous version under the &#8220;versions&#8221; tab.</p>
</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper"><p class="logo"><a href="index.html">
  <img class="logo" src="http://cloud.github.com/downloads/ask/celery/celery_128.png" alt="Logo"/>
</a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="cookbook/daemonizing.html"
                        title="previous chapter">Running celeryd as a daemon</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="community.html"
                        title="next chapter">Community Resources</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/contributing.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="community.html" title="Community Resources"
             >next</a> |</li>
        <li class="right" >
          <a href="cookbook/daemonizing.html" title="Running celeryd as a daemon"
             >previous</a> |</li>
        <li><a href="index.html">Celery v2.4.0a1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009-2011, Ask Solem &amp; Contributors.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>